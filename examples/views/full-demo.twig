{# ====================================================================== #}
{# full-demo.twig                                                         #}
{# A "kitchen sink" template showing:                                     #}
{#   - variables / filters / math                                         #}
{#   - conditionals / loops / for-else                                    #}
{#   - block / extends / embed                                            #}
{#   - include / import / macro / set                                     #}
{#   - loop helpers, spaceless, raw                                       #}
{#   - dump() (in debug)                                                  #}
{#   - our helpers: view(), fragment()                                    #}
{#   - globals: appName, csrf, auth                                       #}
{# ====================================================================== #}

{% extends "layouts/base.twig" %}

{% block title %}Full Demo | {{ appName }}{% endblock %}

{% block body %}

  <main class="p-6 space-y-10 font-sans text-slate-800">
    <header class="border-b pb-4 flex items-start justify-between">
      <div>
        <h1 class="text-3xl font-bold">
          Twig / Marwa\View Demo
        </h1>

        <p class="text-sm text-slate-500">
          Hello,
          {{ user.name|default('Guest')|title }}!
          <br>

          You are inside <strong>{{ appName }}</strong>.

          (CSRF token:
          <code class="text-xs">{{ csrf }}</code>)
        </p>
      </div>

      <div class="text-right text-xs text-slate-500">
        Logged in for approx
        {{ (user.session_minutes / 60)|number_format(2, '.', ',') }}
        hours
        <br>

        Account created:
        {{ user.created_at|date("Y-m-d H:i") }}
      </div>
    </header>


    {# ------------------------------------------------------------------ #}
    {# CONDITIONALS                                                       #}
    {# ------------------------------------------------------------------ #}
    <section class="space-y-2">
      <h2 class="text-xl font-semibold">Conditional Logic</h2>

      {% if user.is_admin %}
        <div class="p-3 rounded bg-green-100 text-green-800 text-sm">
          ‚úÖ You have administrator access.
        </div>
      {% elseif user.role == 'manager' %}
        <div class="p-3 rounded bg-blue-100 text-blue-800 text-sm">
          üëã Manager dashboard is enabled.
        </div>
      {% else %}
        <div class="p-3 rounded bg-yellow-100 text-yellow-800 text-sm">
          ‚ÑπÔ∏è Standard user privileges.
        </div>
      {% endif %}
    </section>


    {# ------------------------------------------------------------------ #}
    {# LOOPS + for ... else                                               #}
    {# ------------------------------------------------------------------ #}
    <section class="space-y-3">
      <h2 class="text-xl font-semibold">Looping Over Collections</h2>

      <div class="rounded border">
        <table class="w-full text-left text-sm">
          <thead class="bg-slate-100 text-slate-700">
            <tr>
              <th class="p-2">#</th>
              <th class="p-2">Client</th>
              <th class="p-2">Status</th>
              <th class="p-2 text-right">Revenue</th>
            </tr>
          </thead>
          <tbody class="divide-y">
          {% for client in clients %}
            <tr class="hover:bg-slate-50">
              <td class="p-2 text-slate-400">{{ loop.index }}</td>
              <td class="p-2 font-medium">{{ client.name }}</td>
              <td class="p-2">
                {% if client.active %}
                  <span class="text-green-600 font-semibold">Active</span>
                {% else %}
                  <span class="text-slate-400 italic">Inactive</span>
                {% endif %}
              </td>
              <td class="p-2 text-right">
                {{ client.revenue_monthly|number_format(2, '.', ',') }} ‡ß≥
              </td>
            </tr>
          {% else %}
            <tr>
              <td colspan="4" class="p-4 text-center text-slate-400">
                No clients found.
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>

      <p class="text-xs text-slate-500">
        Total revenue this month:
        {% set total = 0 %}
        {% for client in clients %}
          {% set total = total + client.revenue_monthly %}
        {% endfor %}
        <strong>{{ total|number_format(2,'.',',') }} ‡ß≥</strong>
      </p>
    </section>


    {# ------------------------------------------------------------------ #}
    {# SET / FILTERS / STRING OPS                                        #}
    {# ------------------------------------------------------------------ #}
    <section class="space-y-2">
      <h2 class="text-xl font-semibold">Variable Manipulation</h2>

      {% set welcome = "hello " ~ user.name|default('friend') %}
      {% set shout = welcome|upper %}

      <div class="rounded bg-slate-900 text-slate-100 p-4 text-xs font-mono leading-relaxed">
        welcome = "{{ welcome }}"<br>
        shout   = "{{ shout }}"<br>
        length  = {{ welcome|length }} chars<br>
        now     = {{ "now"|date("c") }}<br>
      </div>
    </section>



    {# ------------------------------------------------------------------ #}
    {# FOOTER VIA include                                                #}
    {# ------------------------------------------------------------------ #}
    <footer class="pt-10 text-center text-[11px] text-slate-400">
      {% include "partials/footer.twig" %}
    </footer>

  </main>

{% endblock %}
